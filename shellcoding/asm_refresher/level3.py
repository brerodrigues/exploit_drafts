import glob
from pwn import *

"""
math operations on registers_use and memory. For shorthand, when we say
A += B, it really means, A = A + B. Here are some useful instructions:
add reg1, reg2       <=>     reg1 += reg2
sub reg1, reg2       <=>     reg1 -= reg2
imul reg1, reg2      <=>     reg1 *= reg2
div  is a littler harder, we will discuss it later.
"""

context.arch = "amd64"
#context.log_level = "DEBUG"

# pwntools will change SYS_exit to the respective syscall
assembly = """
    imul rdi, rsi
    add rdi, rdx
    mov rax, rdi
"""

shellcode = asm(assembly, arch="amd64", os="linux")
#print(disasm(shellcode))

p = process(glob.glob('/challenge/embry*'))
print(p.recv(timeout=2).decode())
p.send(shellcode)
print(p.recvall().decode())