import glob
from pwn import *

context.arch = "amd64"
#context.log_level = "DEBUG"

# pwntools will change SYS_exit to the respective syscall
assembly = """
    add rdi, 0x331337

    mov rax, SYS_exit
    syscall
"""

shellcode = asm(assembly, arch="amd64", os="linux")
print(disasm(shellcode))

p = process(glob.glob('/challenge/embry*'))
print(p.recv(timeout=2).decode())
p.send(shellcode)
print(p.recvall().decode())